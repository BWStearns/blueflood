<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Blueflood by rackerlabs</title>
    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script src="javascripts/respond.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <!--[if lt IE 8]>
    <link rel="stylesheet" href="stylesheets/ie.css">
    <![endif]-->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

  </head>
  <body>
      <div id="header">
        <nav>
          <li class="fork"><a href="https://github.com/rackerlabs/blueflood">View On GitHub</a></li>
          <li class="downloads"><a href="https://github.com/rackerlabs/blueflood/zipball/master">ZIP</a></li>
          <li class="downloads"><a href="https://github.com/rackerlabs/blueflood/tarball/master">TAR</a></li>
          <li class="title">DOWNLOADS</li>
        </nav>
      </div><!-- end header -->

    <div class="wrapper">

      <section>
        <div id="title">
          <h1>Blueflood</h1>
          <p></p>
          <hr>
          <span class="credits left">Project maintained by <a href="https://github.com/rackerlabs">rackerlabs</a></span>
          <span class="credits right">Hosted on GitHub Pages &mdash; Theme by <a href="https://twitter.com/michigangraham">mattgraham</a></span>
        </div>

        <p><img src="http://i.imgur.com/fM087yS.gif" alt="Blueflood"></p>

<h1>
<a name="blueflood" class="anchor" href="#blueflood"><span class="octicon octicon-link"></span></a>Blueflood</h1>

<p><a href="https://groups.google.com/forum/#!forum/blueflood-discuss">Discuss</a> - <a href="http://github.com/rackerlabs/blueflood">Code</a> - <a href="http://blueflood.io">Site</a></p>

<h2>
<a name="introduction" class="anchor" href="#introduction"><span class="octicon octicon-link"></span></a>Introduction</h2>

<p>Blueflood is a multi-tenant distributed metric processing system created by engineers at 
<a href="http://www.rackspace.com">Rackspace</a>.
It is used in production by the <a href="http://www.rackspace.com/cloud/monitoring/">Cloud Monitoring</a>
team to process metrics generated by their monitoring systems.
Blueflood is capable of ingesting, rolling up and serving metrics at a massive scale.</p>

<h2>
<a name="getting-started" class="anchor" href="#getting-started"><span class="octicon octicon-link"></span></a>Getting Started</h2>

<p>The latest code will always be here on Github.</p>

<pre><code>git clone git@github.com:rackerlabs/blueflood.git
cd blueflood
</code></pre>

<p>You can run the entire suite of tests using Maven:</p>

<pre><code>mvn test integration-test
</code></pre>

<h3>
<a name="building" class="anchor" href="#building"><span class="octicon octicon-link"></span></a>Building</h3>

<p>Build an <a href="http://stackoverflow.com/questions/11947037/what-is-an-uber-jar">'uber jar'</a> using maven:</p>

<pre><code>mvn package
</code></pre>

<p>The uber jar will be found in ${BLUEFLOOD_DIR}/blueflood-all/target/blueflood-all-${VERSION}-jar-with-dependencies.jar.
This jar contains all the dependencies necessary to run Blueflood with a very simple classpath.</p>

<h3>
<a name="running" class="anchor" href="#running"><span class="octicon octicon-link"></span></a>Running</h3>

<p>The best place to start is the <a href="https://github.com/rackerlabs/blueflood/wiki/10minuteguide">10 minute guide</a>.
In a nutshell, you must do this:</p>

<pre><code>java -cp /path/to/uber.jar \
-Dblueflood.config=file:///path/to/blueflood.conf \
-Dlog4j.configuration=file:///path/to/log4j.properties \
com.rackspacecloud.blueflood.service.BluefloodServiceStarter
</code></pre>

<p>Each configuration option can be found in Configuration.java.  Each of those can be overridden on the command line by
doing:</p>

<pre><code>-DCONFIG_OPTION=NEW_VALUE
</code></pre>

<h2>
<a name="development" class="anchor" href="#development"><span class="octicon octicon-link"></span></a>Development</h2>

<p>We anticipate different use cases for Blueflood.  For example, at Rackspace it made more sense to create a
<a href="http://thrift.apache.org">Thrift</a> layer for ingestion and query.  We have chosen not to release that layer because
it contains a lot of code that is specific to our infrastructure and other backend systems.</p>

<p>We decided to release Blueflood with reference HTTP-based ingestion and query layers.  These layers may be replaced by
code that works better with your enterprise.</p>

<h3>
<a name="custom-ingestion" class="anchor" href="#custom-ingestion"><span class="octicon octicon-link"></span></a>Custom Ingestion</h3>

<p>Several things must be done to properly ingest data:
1. Full resolution data must be written via <code>AstyanaxWriter.insertFull()</code>.
2. A <code>ScheduleContext</code> object must be <code>update()</code>d regarding that metrics shard and collection time.
3. Shard state must be periodically pushed to the database for each shard that metrics have been collected for.  This
   can be done by getting the dirty slot information from the <code>ShardStateManager</code> associated with a particular
   <code>ScheduleContext</code> object.</p>

<p><code>HttpMetricsIngestionServer</code> is an example of how to set up a multi-threaded staged ingestion pipeline.</p>

<h3>
<a name="custom-querying" class="anchor" href="#custom-querying"><span class="octicon octicon-link"></span></a>Custom Querying</h3>

<p>Thankfully, querying is easier than ingestion.  Whatever query service you create should have a handler that extends
<code>RollupHandler</code>, which provides a basic wrapping of low level read operations provided by <code>AstyanaxReader</code>.</p>

<h2>
<a name="operations" class="anchor" href="#operations"><span class="octicon octicon-link"></span></a>Operations</h2>

<p>Blueflood exposes a great deal of internal performance metrics over
<a href="https://blogs.oracle.com/jmxetc/entry/what_is_jmx">JMX</a>.
Blueflood respects the standard JMX JVM settings:</p>

<pre><code>com.sun.management.jmxremote.authenticate
com.sun.management.jmxremote.ssl
java.rmi.server.hostname
com.sun.management.jmxremote.port
</code></pre>

<p>You can use any tool that supports JMX to get internal performance metrics out of Blueflood.</p>

<p>Additionally, internal performance metrics can be pushed directly to a <a href="http://graphite.wikidot.com/">Graphite</a> 
service by specifying the following in your Blueflood
configuration:</p>

<pre><code>GRAPHITE_HOST
GRAPHITE_PORT
GRAPHITE_PREFIX
</code></pre>

<h2>
<a name="contributing" class="anchor" href="#contributing"><span class="octicon octicon-link"></span></a>Contributing</h2>

<p>First, we welcome bug reports and contributions.
If you would like to contribute code, just fork this project and send us a pull request.
If you would like to contribute documentation, you should get familiar with
<a href="https://github.com/rackerlabs/blueflood/wiki">our wiki</a></p>

<p>Also, we have set up a <a href="https://groups.google.com/forum/#!forum/blueflood-discuss">Google Group</a> to answer questions.
If you prefer IRC, most of the Blueflood developers are in #blueflood on Freenode.</p>

<h2>
<a name="license" class="anchor" href="#license"><span class="octicon octicon-link"></span></a>License</h2>

<p>Copyright 2013 Rackspace</p>

<p>Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at</p>

<p><a href="http://www.apache.org/licenses/LICENSE-2.0">http://www.apache.org/licenses/LICENSE-2.0</a></p>

<p>Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.</p>
      </section>

    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
              <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-42769648-1");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

  </body>
</html>
